<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Тест предпринимательских компетенций</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question {
            margin-bottom: 30px;
            padding: 15px;
            border-left: 4px solid #007bff;
            background-color: #f8f9fa;
        }
        .question label {
            font-weight: 600;
            color: #2c3e50;
            display: block;
            margin-bottom: 15px;
            font-size: 1.1em;
        }
        .options {
            margin-left: 20px;
        }
        .options label {
            display: block;
            margin: 10px 0;
            padding: 12px;
            background: white;
            border-radius: 6px;
            transition: background 0.3s;
        }
        .options label:hover {
            background: #e9ecef;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            width: 100%;
            margin-top: 20px;
            transition: background 0.3s;
        }
        button:hover {
            background: #0056b3;
        }
        .result {
            margin-top: 30px;
            padding: 20px;
            background: #e9f5ff;
            border-radius: 8px;
            font-size: 1.2em;
        }
        .skills-section {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
        }
        .soft-skills {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
        }
        .hard-skills {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        .progress-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 5px;
            margin: 10px 0;
        }
        .progress-bar {
            height: 20px;
            border-radius: 5px;
            text-align: center;
            line-height: 20px;
            color: white;
        }
        .soft-progress {
            background-color: #4caf50;
        }
        .hard-progress {
            background-color: #2196f3;
        }
        .section-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .user-info {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .user-info input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .admin-section {
            display: none;
            margin-top: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 8px;
        }
        .admin-btn {
            background: #6c757d;
            margin-bottom: 20px;
        }
        .admin-btn:hover {
            background: #5a6268;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .export-buttons {
            margin-top: 20px;
            display: flex;
            gap: 10px;
        }
        .export-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        .clear-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        .admin-controls {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .email-sending {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f5e9;
            border-radius: 8px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 style="color: #2c3e50; text-align: center; margin-bottom: 30px;">Тест предпринимательских компетенций</h1>
        
        <div class="user-info" id="user-info">
            <h3>Пожалуйста, представьтесь:</h3>
            <input type="text" id="fullname" placeholder="Фамилия Имя Отчество" required>
            <input type="tel" id="phone" placeholder="Номер телефона" required>
            <input type="email" id="email" placeholder="Email (необязательно)">
            <button type="button" onclick="startTest()">Начать тест</button>
        </div>
        
        <button class="admin-btn" onclick="showAdminSection()">Раздел для руководителей</button>
        
        <div class="admin-section" id="admin-section">
            <h3>Доступ к результатам</h3>
            <input type="password" id="admin-password" placeholder="Введите пароль">
            <button type="button" onclick="checkAdminPassword()">Показать результаты</button>
            
            <div class="admin-controls" id="admin-controls" style="display: none;">
                <div class="export-buttons">
                    <button class="export-btn" onclick="exportToCSV()">Экспорт в CSV</button>
                    <button class="export-btn" onclick="exportToJSON()">Экспорт в JSON</button>
                    <button class="clear-btn" onclick="clearResults()">Очистить результаты</button>
                </div>
                <div id="results-table"></div>
            </div>
        </div>
        
        <form id="entrepreneur-test" style="display: none;">
            <h2 style="color: #4caf50; margin-top: 30px;">Soft-навыки (мягкие компетенции)</h2>
            
            <!-- Вопросы 1-18 -->
            <div class="question">
                <label>1. Уверены ли Вы в том, что способны вдохновлять команду на совместную работу и принятие общих ценностей?</label>
                <div class="options">
                    <label><input type="radio" name="q1" value="1"> Совсем не уверен</label>
                    <label><input type="radio" name="q1" value="2"> Скорее не уверен</label>
                    <label><input type="radio" name="q1" value="3"> Нейтрально</label>
                    <label><input type="radio" name="q1" value="4"> Скорее уверен</label>
                    <label><input type="radio" name="q1" value="5"> Полностью уверен</label>
                </div>
            </div>
            
           <!-- Вопрос 2 -->
            <div class="question">
                <label>2. Какой стиль управления вы предпочитаете?</label>
                <div class="options">
                    <label><input type="radio" name="q2" value="1"> Демократический</label>
                    <label><input type="radio" name="q2" value="2"> Директивный</label>
                    <label><input type="radio" name="q2" value="3"> Ситуативный</label>
                    <label><input type="radio" name="q2" value="4"> Либеральный</label>
                    <label><input type="radio" name="q2" value="5"> Смешанный</label>
                </div>
            </div>

            <!-- Вопрос 3 -->
            <div class="question">
                <label>3. Как вы поступаете, если команда не согласна с вашим решением?</label>
                <div class="options">
                    <label><input type="radio" name="q3" value="1"> Провожу дополнительное обсуждение, чтобы найти компромисс</label>
                    <label><input type="radio" name="q3" value="2"> Настаиваю на своём решении, так как уверен в его правильности</label>
                    <label><input type="radio" name="q3" value="3"> Пересматриваю решение с учётом мнения команды</label>
                    <label><input type="radio" name="q3" value="4"> Делегирую принятие решения команде</label>
                    <label><input type="radio" name="q3" value="5"> Игнорирую несогласие, так как считаю его необоснованным</label>
                </div>
            </div>

            <!-- Вопрос 4 -->
            <div class="question">
                <label>4. Как часто вы сталкиваетесь с необходимостью радикально менять свои планы в профессиональной среде?</label>
                <div class="options">
                    <label><input type="radio" name="q4" value="1"> Почти никогда</label>
                    <label><input type="radio" name="q4" value="2"> Редко</label>
                    <label><input type="radio" name="q4" value="3"> Иногда</label>
                    <label><input type="radio" name="q4" value="4"> Часто</label>
                    <label><input type="radio" name="q4" value="5"> Почти всегда</label>
                </div>
            </div>

            <!-- Вопрос 5 -->
            <div class="question">
                <label>5. Как вы реагируете на необходимость изменить планы из-за внешних обстоятельств?</label>
                <div class="options">
                    <label><input type="radio" name="q5" value="1"> Провожу анализ ситуации и разрабатываю новый план</label>
                    <label><input type="radio" name="q5" value="2"> Быстро адаптируюсь и вношу изменения без детального анализа</label>
                    <label><input type="radio" name="q5" value="3"> Обращаюсь за помощью к коллегам или экспертам</label>
                    <label><input type="radio" name="q5" value="4"> Стараюсь минимизировать изменения, чтобы сохранить первоначальный план</label>
                    <label><input type="radio" name="q5" value="5"> Игнорирую изменения и продолжаю действовать по старому плану</label>
                </div>
            </div>

            <!-- Вопрос 6 -->
            <div class="question">
                <label>6. Как вы справляетесь с изменениями в личной жизни, которые влияют на вашу профессиональную деятельность?</label>
                <div class="options">
                    <label><input type="radio" name="q6" value="1"> Легко адаптируюсь и нахожу баланс</label>
                    <label><input type="radio" name="q6" value="2"> Стараюсь разделять личную и профессиональную жизнь</label>
                    <label><input type="radio" name="q6" value="3"> Обращаюсь за поддержкой к коллегам или друзьям</label>
                    <label><input type="radio" name="q6" value="4"> Чувствую стресс, но продолжаю работать</label>
                    <label><input type="radio" name="q6" value="5"> Теряю продуктивность и не могу справиться с изменениями</label>
                </div>
            </div>

            <!-- Вопрос 7 -->
            <div class="question">
                <label>7. Как вы оцениваете своё умение предвидеть долгосрочные последствия своих решений?</label>
                <div class="options">
                    <label><input type="radio" name="q7" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q7" value="2"> Редко удаётся</label>
                    <label><input type="radio" name="q7" value="3"> Иногда удаётся</label>
                    <label><input type="radio" name="q7" value="4"> Часто удаётся</label>
                    <label><input type="radio" name="q7" value="5"> Почти всегда удаётся</label>
                </div>
            </div>

            <!-- Вопрос 8 -->
            <div class="question">
                <label>8. Как вы поступаете, если ваша стратегия не приносит ожидаемых результатов?</label>
                <div class="options">
                    <label><input type="radio" name="q8" value="1"> Провожу анализ и корректирую стратегию</label>
                    <label><input type="radio" name="q8" value="2"> Увеличиваю ресурсы для реализации текущей стратегии</label>
                    <label><input type="radio" name="q8" value="3"> Обращаюсь за советом к экспертам</label>
                    <label><input type="radio" name="q8" value="4"> Отказываюсь от стратегии и переключаюсь на новую</label>
                    <label><input type="radio" name="q8" value="5"> Продолжаю действовать по текущей стратегии, надеясь на улучшение</label>
                </div>
            </div>

            <!-- Вопрос 9 -->
            <div class="question">
                <label>9. Как вы оцениваете своё умение видеть новые возможности для бизнеса?</label>
                <div class="options">
                    <label><input type="radio" name="q9" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q9" value="2"> Редко удаётся</label>
                    <label><input type="radio" name="q9" value="3"> Иногда удаётся</label>
                    <label><input type="radio" name="q9" value="4"> Часто удаётся</label>
                    <label><input type="radio" name="q9" value="5"> Почти всегда удаётся</label>
                </div>
            </div>

            <!-- Вопрос 10 -->
            <div class="question">
                <label>10. Как вы выстраиваете коммуникацию с партнёрами и клиентами?</label>
                <div class="options">
                    <label><input type="radio" name="q10" value="1"> Стараюсь быть максимально открытым и прозрачным</label>
                    <label><input type="radio" name="q10" value="2"> Использую формальный подход, чтобы избежать конфликтов</label>
                    <label><input type="radio" name="q10" value="3"> Адаптирую стиль общения в зависимости от ситуации</label>
                    <label><input type="radio" name="q10" value="4"> Предпочитаю письменную коммуникацию для чёткости</label>
                    <label><input type="radio" name="q10" value="5"> Избегаю лишнего общения, сосредотачиваясь на задачах</label>
                </div>
            </div>

            <!-- Вопрос 11 -->
            <div class="question">
                <label>11. Как вы решаете конфликты в команде?</label>
                <div class="options">
                    <label><input type="radio" name="q11" value="1"> Провожу индивидуальные беседы с участниками конфликта</label>
                    <label><input type="radio" name="q11" value="2"> Организую командные обсуждения для поиска решения</label>
                    <label><input type="radio" name="q11" value="3"> Перераспределяю задачи, чтобы минимизировать взаимодействие</label>
                    <label><input type="radio" name="q11" value="4"> Игнорирую конфликт, надеясь, что он разрешится сам</label>
                    <label><input type="radio" name="q11" value="5"> Увольняю участников конфликта, если они не могут договориться</label>
                </div>
            </div>

            <!-- Вопрос 12 -->
            <div class="question">
                <label>12. Как вы оцениваете свои навыки ведения переговоров?</label>
                <div class="options">
                    <label><input type="radio" name="q12" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q12" value="2"> Редко удаётся достичь соглашения</label>
                    <label><input type="radio" name="q12" value="3"> Иногда удаётся достичь соглашения</label>
                    <label><input type="radio" name="q12" value="4"> Часто удаётся достичь соглашения</label>
                    <label><input type="radio" name="q12" value="5"> Почти всегда удаётся достичь соглашения</label>
                </div>
            </div>

            <!-- Вопрос 13 -->
            <div class="question">
                <label>13. Как вы справляетесь с управлением несколькими проектами одновременно?</label>
                <div class="options">
                    <label><input type="radio" name="q13" value="1"> Не справляюсь</label>
                    <label><input type="radio" name="q13" value="2"> С трудом</label>
                    <label><input type="radio" name="q13" value="3"> Умеренно</label>
                    <label><input type="radio" name="q13" value="4"> Хорошо</label>
                    <label><input type="radio" name="q13" value="5"> Отлично</label>
                </div>
            </div>

            <!-- Вопрос 14 -->
            <div class="question">
                <label>14. Как вы организуете свои задачи и проекты?</label>
                <div class="options">
                    <label><input type="radio" name="q14" value="1"> Без системы</label>
                    <label><input type="radio" name="q14" value="2"> Использую простые списки</label>
                    <label><input type="radio" name="q14" value="3"> Использую таск-менеджеры</label>
                    <label><input type="radio" name="q14" value="4"> Использую сложные системы планирования</label>
                    <label><input type="radio" name="q14" value="5"> Делегирую задачи команде</label>
                </div>
            </div>

            <!-- Вопрос 15 -->
            <div class="question">
                <label>15. Как вы поступаете, если проект отстаёт от графика?</label>
                <div class="options">
                    <label><input type="radio" name="q15" value="1"> Увеличиваю количество ресурсов на проект</label>
                    <label><input type="radio" name="q15" value="2"> Пересматриваю сроки и приоритеты задач</label>
                    <label><input type="radio" name="q15" value="3"> Провожу встречу с командой для поиска решений</label>
                    <label><input type="radio" name="q15" value="4"> Ускорю выполнение задач за счёт качества</label>
                    <label><input type="radio" name="q15" value="5"> Обращаюсь за помощью к внешним консультантам</label>
                </div>
            </div>

            <!-- Вопрос 16 -->
            <div class="question">
                <label>16. Как вы оцениваете свою креативность?</label>
                <div class="options">
                    <label><input type="radio" name="q16" value="1"> Совсем не креативен</label>
                    <label><input type="radio" name="q16" value="2"> Редко проявляю креативность</label>
                    <label><input type="radio" name="q16" value="3"> Иногда проявляю креативность</label>
                    <label><input type="radio" name="q16" value="4"> Часто проявляю креативность</label>
                    <label><input type="radio" name="q16" value="5"> Постоянно проявляю креативность</label>
                </div>
            </div>

            <!-- Вопрос 17 -->
            <div class="question">
                <label>17. Как вы справляетесь со стрессом в сложных ситуациях?</label>
                <div class="options">
                    <label><input type="radio" name="q17" value="1"> Легко адаптируюсь и нахожу решения</label>
                    <label><input type="radio" name="q17" value="2"> Стараюсь сохранять спокойствие, но испытываю напряжение</label>
                    <label><input type="radio" name="q17" value="3"> Обращаюсь за поддержкой к коллегам или друзьям</label>
                    <label><input type="radio" name="q17" value="4"> Чувствую сильный стресс, но продолжаю работать</label>
                    <label><input type="radio" name="q17" value="5"> Теряю продуктивность и не могу справиться</label>
                </div>
            </div>

            <!-- Вопрос 18 -->
            <div class="question">
                <label>18. Как вы оцениваете свою способность к обучению и адаптации?</label>
                <div class="options">
                    <label><input type="radio" name="q18" value="1"> Совсем не способен</label>
                    <label><input type="radio" name="q18" value="2"> Редко удаётся адаптироваться</label>
                    <label><input type="radio" name="q18" value="3"> Иногда удаётся адаптироваться</label>
                    <label><input type="radio" name="q18" value="4"> Часто удаётся адаптироваться</label>
                    <label><input type="radio" name="q18" value="5"> Почти всегда удаётся адаптироваться</label>
                </div>
            </div>

            <h2 style="color: #2196f3; margin-top: 50px;">Hard-навыки (технические компетенции)</h2>

            <!-- Вопрос 19 -->
            <div class="question">
                <label>19. Как часто вы используете цифровые инструменты (таск-менеджеры, CRM, аналитические системы) в работе?</label>
                <div class="options">
                    <label><input type="radio" name="q19" value="1"> Почти никогда</label>
                    <label><input type="radio" name="q19" value="2"> Редко</label>
                    <label><input type="radio" name="q19" value="3"> Иногда</label>
                    <label><input type="radio" name="q19" value="4"> Часто</label>
                    <label><input type="radio" name="q19" value="5"> Постоянно</label>
                </div>
            </div>

            <!-- Вопрос 20 -->
            <div class="question">
                <label>20. Как вы оцениваете своё умение работать с современными мессенджерами (Slack, Teams, Telegram и др.) для управления командой?</label>
                <div class="options">
                    <label><input type="radio" name="q20" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q20" value="2"> Использую только базовые функции</label>
                    <label><input type="radio" name="q20" value="3"> Умею создавать каналы и группы</label>
                    <label><input type="radio" name="q20" value="4"> Умею интегрировать с другими инструментами</label>
                    <label><input type="radio" name="q20" value="5"> Профессионально использую все возможности</label>
                </div>
            </div>

            <!-- Вопрос 21 -->
            <div class="question">
                <label>21. Как вы используете системы таскинга (Trello, Asana, Jira и др.) в управлении проектами?</label>
                <div class="options">
                    <label><input type="radio" name="q21" value="1"> Не использую</label>
                    <label><input type="radio" name="q21" value="2"> Использую для личных задач</label>
                    <label><input type="radio" name="q21" value="3"> Использую для командной работы</label>
                    <label><input type="radio" name="q21" value="4"> Умею настраивать сложные workflows</label>
                    <label><input type="radio" name="q21" value="5"> Профессионально использую для стратегического управления</label>
                </div>
            </div>

            <!-- Вопрос 22 -->
            <div class="question">
                <label>22. Как вы применяете искусственный интеллект и нейросети в своей работе?</label>
                <div class="options">
                    <label><input type="radio" name="q22" value="1"> Не использую</label>
                    <label><input type="radio" name="q22" value="2"> Использую для личных задач (например, ChatGPT)</label>
                    <label><input type="radio" name="q22" value="3"> Использую для генерации контента</label>
                    <label><input type="radio" name="q22" value="4"> Использую для анализа данных</label>
                    <label><input type="radio" name="q22" value="5"> Интегрирую в бизнес-процессы компании</label>
                </div>
            </div>

            <!-- Вопрос 23 -->
            <div class="question">
                <label>23. Как вы оцениваете своё умение структурировать задачи в таск-менеджерах для реализации стратегических целей?</label>
                <div class="options">
                    <label><input type="radio" name="q23" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q23" value="2"> Создаю простые списки задач</label>
                    <label><input type="radio" name="q23" value="3"> Умею группировать задачи по проектам</label>
                    <label><input type="radio" name="q23" value="4"> Умею связывать задачи с KPI</label>
                    <label><input type="radio" name="q23" value="5"> Строю сложные системы задач для стратегического управления</label>
                </div>
            </div>

            <!-- Вопрос 24 -->
            <div class="question">
                <label>24. Как вы используете облачные сервисы (Google Workspace, Microsoft 365, Notion и др.) в работе?</label>
                <div class="options">
                    <label><input type="radio" name="q24" value="1"> Не использую</label>
                    <label><input type="radio" name="q24" value="2"> Использую для хранения файлов</label>
                    <label><input type="radio" name="q24" value="3"> Использую для совместной работы</label>
                    <label><input type="radio" name="q24" value="4"> Интегрирую несколько сервисов между собой</label>
                    <label><input type="radio" name="q24" value="5"> Строю на их основе всю цифровую инфраструктуру компании</label>
                </div>
            </div>

            <!-- Вопрос 25 -->
            <div class="question">
                <label>25. Как вы оцениваете своё умение анализировать данные с помощью цифровых инструментов (Excel, Google Sheets, BI-систем)?</label>
                <div class="options">
                    <label><input type="radio" name="q25" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q25" value="2"> Умею работать с простыми таблицами</label>
                    <label><input type="radio" name="q25" value="3"> Умею использовать формулы и сводные таблицы</label>
                    <label><input type="radio" name="q25" value="4"> Умею создавать сложные аналитические отчёты</label>
                    <label><input type="radio" name="q25" value="5"> Профессионально использую для стратегического анализа</label>
                </div>
            </div>

            <!-- Вопрос 26 -->
            <div class="question">
                <label>26. Как вы используете автоматизацию процессов (Zapier, Make, Power Automate и др.) в бизнесе?</label>
                <div class="options">
                    <label><input type="radio" name="q26" value="1"> Не использую</label>
                    <label><input type="radio" name="q26" value="2"> Использую готовые шаблоны</label>
                    <label><input type="radio" name="q26" value="3"> Создаю простые сценарии автоматизации</label>
                    <label><input type="radio" name="q26" value="4"> Создаю сложные цепочки автоматизации</label>
                    <label><input type="radio" name="q26" value="5"> Разрабатываю комплексные системы автоматизации бизнес-процессов</label>
                </div>
            </div>

            <!-- Вопрос 27 -->
            <div class="question">
                <label>27. Как вы оцениваете своё умение выбирать цифровые инструменты под конкретные бизнес-задачи?</label>
                <div class="options">
                    <label><input type="radio" name="q27" value="1"> Совсем не умею</label>
                    <label><input type="radio" name="q27" value="2"> Полагаюсь на рекомендации других</label>
                    <label><input type="radio" name="q27" value="3"> Могу выбрать из известных мне вариантов</label>
                    <label><input type="radio" name="q27" value="4"> Провожу сравнительный анализ перед выбором</label>
                    <label><input type="radio" name="q27" value="5"> Профессионально подбираю и внедряю инструменты</label>
                </div>
            </div>
            
            <button type="button" onclick="calculateScore()">Получить результат</button>
        </form>

        <div class="result" id="result"></div>
        
        <div class="email-sending" id="email-sending">
            <h3>Отправка результатов на email</h3>
            <p id="email-status">Подготовка к отправке...</p>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'entrepreneur_test_results';
        const ADMIN_PASSWORD = 'twinurfu2025';
        
        const weights = {
            q1: 8, q2: 7, q3: 6, q4: 7, q5: 6,
            q6: 5, q7: 8, q8: 7, q9: 6, q10: 5,
            q11: 6, q12: 5, q13: 7, q14: 6, q15: 5,
            q16: 4, q17: 5, q18: 4,
            q19: 6, q20: 5, q21: 7, q22: 8, q23: 7,
            q24: 6, q25: 7, q26: 6, q27: 8
        };

        function startTest() {
            const fullname = document.getElementById('fullname').value;
            const phone = document.getElementById('phone').value;
            
            if (!fullname || !phone) {
                alert('Пожалуйста, заполните обязательные поля: ФИО и номер телефона');
                return;
            }
            
            document.getElementById('user-info').style.display = 'none';
            document.getElementById('entrepreneur-test').style.display = 'block';
        }

        function showAdminSection() {
            document.getElementById('admin-section').style.display = 'block';
        }

        function checkAdminPassword() {
            const password = document.getElementById('admin-password').value;
            if (password === ADMIN_PASSWORD) {
                displayAllResults();
            } else {
                alert('Неверный пароль');
            }
        }

        function sendEmailResults(softScore, hardScore, totalScore) {
            const emailSection = document.getElementById('email-sending');
            emailSection.style.display = 'block';
            
            const fullname = document.getElementById('fullname').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value || 'не указан';
            
            const subject = `Результаты теста: ${fullname}`;
            let body = `Результаты теста предпринимательских компетенций\n\n`;
            body += `Участник: ${fullname}\n`;
            body += `Телефон: ${phone}\n`;
            body += `Email: ${email}\n\n`;
            body += `Результаты:\n`;
            body += `- Общий балл: ${totalScore}\n`;
            body += `- Soft skills: ${softScore}\n`;
            body += `- Hard skills: ${hardScore}\n\n`;
            body += `Ответы на вопросы:\n`;
            
            for (let i = 1; i <= 27; i++) {
                const question = `q${i}`;
                const selected = document.querySelector(`input[name="${question}"]:checked`);
                if (selected) {
                    body += `Вопрос ${i}: ${selected.nextSibling.textContent.trim()}\n`;
                }
            }
            
            const mailtoLink = `mailto:vavinnation@vk.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            
            try {
                document.getElementById('email-status').textContent = 'Открываю почтовый клиент...';
                window.location.href = mailtoLink;
                document.getElementById('email-status').textContent = 'Почтовый клиент открыт. Пожалуйста, отправьте письмо.';
            } catch (e) {
                document.getElementById('email-status').textContent = 'Ошибка при открытии почтового клиента. Скопируйте результаты ниже и отправьте вручную на vavinnation@vk.com';
                emailSection.innerHTML += `<textarea style="width:100%; height:200px; margin-top:10px;">${body}</textarea>`;
            }
        }

        function saveResult(softScore, hardScore, totalScore) {
            const fullname = document.getElementById('fullname').value;
            const phone = document.getElementById('phone').value;
            const email = document.getElementById('email').value;
            
            const result = {
                timestamp: new Date().getTime(),
                user: { fullname, phone, email },
                softScore,
                hardScore,
                totalScore,
                answers: getSelectedAnswers()
            };
            
            const existingResults = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            existingResults.push(result);
            localStorage.setItem(STORAGE_KEY, JSON.stringify(existingResults));
        }

        function getSelectedAnswers() {
            const form = document.getElementById('entrepreneur-test');
            const answers = {};
            
            for (let i = 1; i <= 27; i++) {
                const question = `q${i}`;
                const selected = form.querySelector(`input[name="${question}"]:checked`);
                answers[question] = selected ? selected.value : null;
            }
            
            return answers;
        }

        function calculateScore() {
            let allAnswered = true;
            for (let i = 1; i <= 27; i++) {
                const question = `q${i}`;
                const selected = document.querySelector(`input[name="${question}"]:checked`);
                if (!selected) {
                    allAnswered = false;
                    break;
                }
            }
            
            if (!allAnswered) {
                alert('Пожалуйста, ответьте на все вопросы перед завершением теста.');
                return;
            }
            
            let softScore = 0;
            let hardScore = 0;
            const form = document.getElementById('entrepreneur-test');
            
            for(let i = 1; i <= 18; i++) {
                const question = `q${i}`;
                const selected = form.querySelector(`input[name="${question}"]:checked`);
                if(selected) {
                    softScore += parseInt(selected.value) * weights[question];
                }
            }
            
            for(let i = 19; i <= 27; i++) {
                const question = `q${i}`;
                const selected = form.querySelector(`input[name="${question}"]:checked`);
                if(selected) {
                    hardScore += parseInt(selected.value) * weights[question];
                }
            }

            const softMaxScore = Object.entries(weights)
                .filter(([key]) => parseInt(key.substring(1)) <= 18)
                .reduce((sum, [_, weight]) => sum + weight * 5, 0);
                
            const hardMaxScore = Object.entries(weights)
                .filter(([key]) => parseInt(key.substring(1)) >= 19)
                .reduce((sum, [_, weight]) => sum + weight * 5, 0);
            
            const finalSoftScore = Math.round((softScore / softMaxScore) * 100);
            const finalHardScore = Math.round((hardScore / hardMaxScore) * 100);
            const totalScore = Math.round((finalSoftScore * 0.6 + finalHardScore * 0.4));

            saveResult(finalSoftScore, finalHardScore, totalScore);
            sendEmailResults(finalSoftScore, finalHardScore, totalScore);

            const softText = getSkillInterpretation(finalSoftScore, 'soft');
            const hardText = getSkillInterpretation(finalHardScore, 'hard');
            const totalText = getTotalInterpretation(totalScore);

            document.getElementById('result').innerHTML = `
                <h3>Общий результат: ${totalScore} баллов</h3>
                <p>${totalText}</p>
                
                <div class="skills-section soft-skills">
                    <div class="section-title">Soft-навыки: ${finalSoftScore} баллов</div>
                    <div class="progress-container">
                        <div class="progress-bar soft-progress" style="width: ${finalSoftScore}%">${finalSoftScore}%</div>
                    </div>
                    <p>${softText}</p>
                </div>
                
                <div class="skills-section hard-skills">
                    <div class="section-title">Hard-навыки: ${finalHardScore} баллов</div>
                    <div class="progress-container">
                        <div class="progress-bar hard-progress" style="width: ${finalHardScore}%">${finalHardScore}%</div>
                    </div>
                    <p>${hardText}</p>
                </div>
                
                <h4>Рекомендации по развитию:</h4>
                <p>${getRecommendations(finalSoftScore, finalHardScore)}</p>
            `;
        }

        function displayAllResults() {
            const results = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            if (results.length === 0) {
                document.getElementById('results-table').innerHTML = '<p>Нет сохраненных результатов</p>';
                return;
            }
            
            let tableHTML = `
                <table>
                    <thead>
                        <tr>
                            <th>№</th>
                            <th>Дата</th>
                            <th>ФИО</th>
                            <th>Телефон</th>
                            <th>Email</th>
                            <th>Общий балл</th>
                            <th>Soft skills</th>
                            <th>Hard skills</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            results.forEach((result, index) => {
                tableHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${new Date(result.timestamp).toLocaleString()}</td>
                        <td>${result.user.fullname}</td>
                        <td>${result.user.phone}</td>
                        <td>${result.user.email || '-'}</td>
                        <td>${result.totalScore}</td>
                        <td>${result.softScore}</td>
                        <td>${result.hardScore}</td>
                    </tr>
                `;
            });
            
            tableHTML += `</tbody></table>`;
            document.getElementById('results-table').innerHTML = tableHTML;
            document.getElementById('admin-controls').style.display = 'block';
        }

        function exportToCSV() {
            const results = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            if (results.length === 0) {
                alert('Нет данных для экспорта');
                return;
            }
            
            let csv = '№;Дата;ФИО;Телефон;Email;Общий балл;Soft skills;Hard skills\n';
            
            results.forEach((result, index) => {
                csv += `${index + 1};"${new Date(result.timestamp).toLocaleString()}";"${result.user.fullname}";"${result.user.phone}";"${result.user.email || ''}";${result.totalScore};${result.softScore};${result.hardScore}\n`;
            });
            
            const blob = new Blob(["\uFEFF" + csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `результаты_теста_${new Date().toISOString().slice(0,10)}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function exportToJSON() {
            const results = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            if (results.length === 0) {
                alert('Нет данных для экспорта');
                return;
            }
            
            const dataStr = JSON.stringify(results, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `результаты_теста_${new Date().toISOString().slice(0,10)}.json`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function clearResults() {
            if (confirm('Вы уверены, что хотите удалить все результаты? Это действие нельзя отменить.')) {
                localStorage.removeItem(STORAGE_KEY);
                document.getElementById('results-table').innerHTML = '<p>Нет сохраненных результатов</p>';
                document.getElementById('admin-controls').style.display = 'none';
            }
        }

        function getSkillInterpretation(score, type) {
            if(type === 'soft') {
                if(score >= 85) return "Отличные мягкие навыки! Вы обладаете выдающимися лидерскими и коммуникативными качествами";
                if(score >= 65) return "Хорошие мягкие навыки. Есть потенциал для дальнейшего развития";
                if(score >= 45) return "Средний уровень мягких навыков. Рекомендуется работа над ключевыми компетенциями";
                return "Низкий уровень мягких навыков. Требуется активное развитие";
            } else {
                if(score >= 85) return "Отличные технические навыки! Вы в совершенстве владеете современными цифровыми инструментами";
                if(score >= 65) return "Хорошие технические навыки. Вы уверенно используете цифровые инструменты";
                if(score >= 45) return "Средний уровень технических навыков. Рекомендуется освоение новых инструментов";
                return "Низкий уровень технических навыков. Требуется обучение цифровым инструментам";
            }
        }

        function getTotalInterpretation(score) {
            if(score >= 85) return "🎉 Превосходный результат! Вы обладаете комплексными предпринимательскими компетенциями";
            if(score >= 65) return "👍 Хороший результат! Ваши навыки сбалансированы, есть потенциал для роста";
            if(score >= 45) return "💡 Средний уровень. Рекомендуется работа над развитием ключевых навыков";
            return "🔍 Требуется развитие. Рекомендуем пройти обучение предпринимательским компетенциям";
        }

        function getRecommendations(softScore, hardScore) {
            let recommendations = [];
            
            if(softScore < 45) {
                recommendations.push("Пройти курсы по развитию лидерских качеств и эмоционального интеллекта");
            } else if(softScore < 65) {
                recommendations.push("Практиковать навыки коммуникации и управления командой");
            }
            
            if(hardScore < 45) {
                recommendations.push("Освоить базовые цифровые инструменты (таск-менеджеры, мессенджеры, облачные сервисы)");
            } else if(hardScore < 65) {
                recommendations.push("Изучить продвинутые функции цифровых инструментов и автоматизацию процессов");
            }
            
            if(softScore >= 65 && hardScore >= 65) {
                recommendations.push("Сфокусироваться на стратегическом развитии бизнеса с использованием ваших сильных сторон");
            } else if(softScore >= 65 && hardScore < 65) {
                recommendations.push("Использовать свои сильные soft skills для компенсации недостающих технических навыков через найм или обучение");
            } else if(softScore < 65 && hardScore >= 65) {
                recommendations.push("Развивать soft skills для более эффективного применения ваших технических компетенций");
            }
            
            if(recommendations.length === 0) {
                return "Продолжайте развивать свои сильные стороны и искать новые возможности для роста";
            }
            
            return recommendations.join("<br>• ");
        }
    </script>
</body>
</html>
